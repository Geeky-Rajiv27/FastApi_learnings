<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Student Management System</title>

<style>
/* ================= BASIC RESET ================= */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

/* ================= PAGE ================= */
body {
    font-family: 'Segoe UI', sans-serif;
    background: #f0f4f8;
    padding: 20px;
}

h1 {
    text-align: center;
    color: #1e90ff;
    margin-bottom: 20px;
}

/* ================= LAYOUT ================= */
.main-container {
    display: flex;
    gap: 20px;
}

/* LEFT SIDE */
.left-panel {
    width: 35%;
}

/* RIGHT SIDE */
.right-panel {
    width: 65%;
    background: #fff;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
}

/* ================= FORMS ================= */
.form-section {
    background: #fff;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 6px 12px rgba(0,0,0,0.1);
    margin-bottom: 20px;
}

.form-section h3 {
    margin-bottom: 10px;
}

input, button {
    width: 100%;
    padding: 10px;
    margin: 6px 0;
    border-radius: 6px;
    border: 1px solid #ccc;
}

button {
    background: #1e90ff;
    color: white;
    border: none;
    font-weight: bold;
    cursor: pointer;
}

button:hover {
    background: #0f7ae5;
}

/* ================= TABLE ================= */
table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
}

th, td {
    padding: 10px;
    border-bottom: 1px solid #ddd;
}

th {
    background: #1e90ff;
    color: white;
}

/* ================= SINGLE STUDENT VIEW ================= */
.student-card {
    background: #f9fbff;
    border: 1px solid #ddd;
    padding: 15px;
    border-radius: 10px;
    margin-top: 15px;
}
</style>
</head>

<body>

<h1>Student Management System</h1>

<div class="main-container">

<!-- ================= LEFT PANEL ================= -->
<div class="left-panel">

    <!-- ADD / UPDATE -->
    <div class="form-section">
        <h3>Add / Update Student</h3>
        <input id="studentId" type="number" placeholder="ID (for update)">
        <input id="name" placeholder="Name">
        <input id="email" placeholder="Email">
        <input id="age" type="number" placeholder="Age">
        <input id="course" placeholder="Course">
        <input id="marks" type="number" placeholder="Marks">

        <button onclick="addStudent()">Add Student</button>
        <button onclick="updateStudent()">Update Student</button>
    </div>

    <!-- DELETE -->
    <div class="form-section">
        <h3>Delete Student</h3>
        <input id="deleteId" type="number" placeholder="Student ID">
        <button onclick="deleteStudent()">Delete</button>
    </div>

    <!-- GET BY ID -->
    <div class="form-section">
        <h3>Get Student By ID</h3>
        <input id="searchId" type="number" placeholder="Enter ID">
        <button onclick="getStudentById()">Fetch Student</button>
    </div>

</div>

<!-- ================= RIGHT PANEL ================= -->
<div class="right-panel">

    <h2>Student Data</h2>
    <button onclick="fetchStudents()">Refresh All Students</button>

    <!-- Single student display -->
    <div id="singleStudent"></div>

    <!-- All students table -->
    <table id="studentsTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Age</th>
                <th>Course</th>
                <th>Marks</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

</div>
</div>

<script>
/* ================= BACKEND URL ================= */
const API_URL = "http://127.0.0.1:8000";

/* ================= CREATE TABLE ROW ================= */
function createRow(s) {
    return `<tr>
        <td>${s.id}</td>
        <td>${s.name}</td>
        <td>${s.email}</td>
        <td>${s.age}</td>
        <td>${s.course}</td>
        <td>${s.marks}</td>
    </tr>`;
}

/* ================= FETCH ALL STUDENTS ================= */
function fetchStudents() {
    // Reset single student view
    document.getElementById("singleStudent").innerHTML = "";

    fetch(`${API_URL}/AllStudents/`)
        .then(res => res.json())
        .then(result => {
            const tbody = document.querySelector("#studentsTable tbody");
            tbody.innerHTML = "";

            result.Data.forEach(s => {
                tbody.innerHTML += createRow(s);
            });
        });
}

/* ================= GET STUDENT BY ID ================= */
function getStudentById() {
    const id = document.getElementById("searchId").value;

    if (!id) {
        alert("Enter student ID");
        return;
    }

    fetch(`${API_URL}/students/${id}`)
        .then(res => {
            if (!res.ok) throw new Error("Student not found");
            return res.json();
        })
        .then(result => {
            const s = result.Details;

            // Clear table
            document.querySelector("#studentsTable tbody").innerHTML = "";

            // Show student data
            document.getElementById("singleStudent").innerHTML = `
                <div class="student-card">
                    <h3>Student Details</h3>
                    <p><b>ID:</b> ${s.id}</p>
                    <p><b>Name:</b> ${s.name}</p>
                    <p><b>Email:</b> ${s.email}</p>
                    <p><b>Age:</b> ${s.age}</p>
                    <p><b>Course:</b> ${s.course}</p>
                    <p><b>Marks:</b> ${s.marks}</p>
                </div>
            `;
        })
        .catch(err => alert(err.message));
}

/* ================= ADD STUDENT ================= */
function addStudent() {
    const student = {
        name: name.value,
        email: email.value,
        age: Number(age.value),
        course: course.value,
        marks: Number(marks.value)
    };

    fetch(`${API_URL}/NewStudent/`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(student)
    })
    .then(() => {
        alert("Student Added");
        fetchStudents();
    });
}

/* ================= UPDATE STUDENT ================= */
function updateStudent() {
    const id = studentId.value;

    const student = {
        name: name.value,
        email: email.value,
        age: Number(age.value),
        course: course.value,
        marks: Number(marks.value)
    };

    fetch(`${API_URL}/UpdateStudent/${id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(student)
    })
    .then(() => {
        alert("Student Updated");
        fetchStudents();
    });
}

/* ================= DELETE STUDENT ================= */
function deleteStudent() {
    const id = deleteId.value;

    fetch(`${API_URL}/DeleteStudent/${id}`, {
        method: "DELETE"
    })
    .then(() => {
        alert("Student Deleted");
        fetchStudents();
    });
}

/* ================= INITIAL LOAD ================= */
fetchStudents();
</script>

</body>
</html>
